## 序言
使用`git merge`合并分支修改并不是一帆风顺的，如果出现相同文件被同时修改的情况，那么大概率会出现冲突。


### 如何解决冲突
解决冲突最直接的办法，就是打开冲突文件，通过编辑逐个解决冲突，完成之后提交。

由于是人工处理，这个编辑过程比较容易出错，最好使用IDE提供的工具来编辑。


### 撤销合并
有时候，合并完代码之后，基于某种原因，比如发现和错分支了😂，需要撤销一下合并。

下面分情况列举撤销合并的方法。
#### 出现了冲突
```
git merge --abort
```
如果明确了只认当前分支的最新代码，可以再次合并
```
git merge --Xours
```
如果是取合并分支的为最新代码
```
git merge --Xtheirs
```
#### 未出现冲突
如果合并提交还没有同步到远程仓库，可以使用下面的命令
```
git reset --hard HEAD~
```
如果已经同步到了远程仓库，使用上面命令之后只能在本地起作用，提交不到远程仓库，需要使用到`revert`命令，如下
```
git revert -m 1 HEAD
```
表示保留主线上的修改，还原合并分支引入的修改，并生成一个新提交，不会影响到远程仓库。

这虽然可以起到撤销合并的作用，但是有个副作用：合并分支已经被认为已经合并入主线分支，只是被还原了而已，合并分支的修改永远无法在主线分支体现出来。

要修复这个副作用，只能再还原一下，假设上述还原之后生成的提交引用为 M，那么执行下面命令后，还原之前的还原，负负得正，之前的合并修改又回来了，如潜水一般。
```
git revert M
```

因此，可以得出以下经验
- 如果是废弃的合并修改，可以放心大胆使用`revert`命令
- 否则，建议手动修改文件撤销，毕竟在未来某个时刻再来`revert`，冲突的风险还是比较大的，尤其多人开发，不好把控。

> 金科玉律：和代码前确认清楚分支是否正确