## 什么是架构
软件架构是软件的顶层设计，它定义了系统的组成角色，角色之间的关联和运行规则。

简称4R：Rank、Role、Relation、Rule。

## 架构的目的
解决软件复杂度带来的问题。

## 复杂度来源
主要有六个来源：

1. 高性能
2. 高可用
3. 高拓展
4. 成本
5. 安全
6. 规模
7. ...

### 高性能架构模式
1. 读写分离
2. 分库分表
3. 高性能NoSQL
4. 并发模型：PPC、TPC、Reactor、Proactor 
5. 任务分配器：F5、LVS、Nginx

### 高可用架构模式
1. 双机架构
2. 集群和分区
3. 异地多活

### 高拓展架构模式
1. 分层
2. 微服务
3. 微内核

这三种架构模式不是非此即彼的，在一个系统中可以灵活组合运用，比如系统采用微服务架构，而每个微服务采用MVC的分层架构。

### 低成本思路
- 大公司：引入新技术+技术创新
- 小公司：只能引入新技术

引入新技术的成本低于技术创新。

### 安全
主要考虑两方面

- 架构安全：防强盗
- 功能安全：防小偷

### 规模
正所谓量变引起质变，当功能或者数据规模达到一定程度时，复杂度会指数级增加。

## 架构原则

1. 合适：贴近实际的业务背景
2. 简单：真正的高手总是能用最简单的方法解决最复杂的问题
3. 演进：这是避免过度设计的指定思想

> 优先级：合适 > 简单 > 演进

## 架构设计流程

1. 识别复杂度
2. 设计备选方案
3. 评估和选择
4. 详细设计

### 识别复杂度
这是重点也是难点，如果没有丰富的经验一眼就能识别出复杂度，那么可以使用排除法遍历复杂度来源，筛选出系统的复杂度。

### 设计备选方案
这是架构模式和架构原则的练兵场，切记

1. 只设计一个方案：因为没有最好的方案，只有最合适的方案，而最合适的方案肯定是在多个合适的方案中决策出来的。
2. 过度设计：考虑演进

### 评估和选择
可以使用360度环评表，主要有以下指标

1. 复杂性
2. 性能
3. 可靠
4. 拓展
5. 运维
6. 硬件成本
7. 人力投入
8. 开发周期

### 详细设计
确认具体组件和组件的使用方式，方便进入开发层面的概要设计和详细设计。